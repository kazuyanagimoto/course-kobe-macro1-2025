---
engine: julia
---

# New Keynesian Model {#sec-nk}

```{julia}
#| label: setup-nk
#| code-fold: true
#| output: false
using DataFrames
using LaTeXStrings
using StatsPlots
using MacroModelling: @model, @parameters, get_irf
using PrettyTables

mypalette = ["#d5968c", "#c2676d", "#5c363a", "#995041", "#45939c", "#0f6a81"]
default(size=(600, 370), titlefontsize=10, fmt=:svg, grid=false,
    foreground_color_legend=nothing, palette=mypalette[[6, 2, 4, 3, 1, 5]])
```

## New Keynesian Model ã¨ã¯

New Keynesian Model ã¨ã¯, RBCãƒ¢ãƒ‡ãƒ«ã«åç›®ã®ç¡¬ç›´æ€§ (nominal rigidity) ã‚’åŠ ãˆãŸãƒ¢ãƒ‡ãƒ«ã§ã™. åç›®è³ƒé‡‘ã‚„åç›®ä¾¡æ ¼ãŒèª¿æ•´ã•ã‚Œã‚‹ã¾ã§ã®æ™‚é–“ãŒã‹ã‹ã‚‹ã“ã¨ã‚’è€ƒæ…®ã—, ã“ã®ã‚ˆã†ãªä¾¡æ ¼ã‚„è³ƒé‡‘ã‚’ sticky price ã‚„ sticky wage ã¨å‘¼ã³ã¾ã™. ã“ã‚Œã«ã‚ˆã‚Š, çŸ­æœŸçš„ãªä¾¡æ ¼ã®ç¡¬ç›´æ€§ãŒç”Ÿã˜, çµŒæ¸ˆã®å¤‰å‹•ã«å¯¾ã™ã‚‹åå¿œãŒé…ã‚Œã‚‹ã“ã¨ã«ãªã‚Šã¾ã™. ãã®çµæœ, åç›®å¤‰æ•° (è²¨å¹£ä¾›çµ¦ã‚„é‡‘åˆ©) ãŒå®Ÿä½“çµŒæ¸ˆã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã“ã¨ãŒå¯èƒ½ã«ãªã‚Šã¾ã™.

$$
\text{New Keynesian Model} = \text{RBC Model} + \text{Nominal Rigidity}.
$$

Dynamic Stochastic General Equilibrium (DSGE) ãƒ¢ãƒ‡ãƒ«ã¨ã„ã†å‘¼ç§°ã‚‚ã‚ã‚Šã¾ã™ãŒ, ã“ã‚Œã¯RBCãƒ¢ãƒ‡ãƒ«ã‚„New Keynesianãƒ¢ãƒ‡ãƒ«ã‚’å«ã‚€, ã‚ˆã‚Šä¸€èˆ¬çš„ãªå‘¼ç§°ã§ã™. ã“ã®æˆæ¥­ã§ã¯RBCãƒ¢ãƒ‡ãƒ«ã¨åŒºåˆ¥ã™ã‚‹ãŸã‚ã«New Keynesianãƒ¢ãƒ‡ãƒ«ã¨å‘¼ã¶ã“ã¨ã«ã—ã¾ã™.

## Nominal Rigidity

### Nominal vs. Real

ã“ã“ã§, ä¾¡æ ¼, åç›®å€¤ã¨å®Ÿè³ªå€¤ã¨ã„ã†æ¦‚å¿µã‚’å°å…¥ã—ã¾ã™.

- $P_t$: åç›®ä¾¡æ ¼ (nominal price). ã¾ãŸã¯ç‰©ä¾¡æ°´æº– (price level)
- $i_t$: åç›®é‡‘åˆ© (nominal interest rate)

ã“ã®æ™‚, ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ (inflation rate) $\pi_t$ ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™.

$$
\pi_t = \frac{P_t - P_{t-1}}{P_{t-1}}.
$$

ä»Šã¾ã§ã®RBCãƒ¢ãƒ‡ãƒ«ã§ã¯, é‡‘åˆ©ã¯å®Ÿè³ªé‡‘åˆ© (real interest rate) $r_t$ ã¨ã—ã¦æ‰±ã£ã¦ãã¾ã—ãŸ. ã“ã“ã§ã„ã†å®Ÿè³ªé‡‘åˆ©ã¨ã¯, åç›®é‡‘åˆ©ã‹ã‚‰ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã‚’å·®ã—å¼•ã„ãŸã‚‚ã®ã§ã‚ã‚Š, ä»¥ä¸‹ã®ã‚ˆã†ã«å®šç¾©ã•ã‚Œã¾ã™.

$$
1 + r_t := \frac{1 + i_t}{1 + \pi_{t+1}}.
$$

ã¾ãŸ, $r_t \pi_{t+1}$ ã¯ç„¡è¦–ã§ãã‚‹ã»ã©ååˆ†å°ã•ã„ã®ã§, è¿‘ä¼¼çš„ã«ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã›ã¾ã™.

$$
r_t \approx i_t - \pi_{t+1}.
$$

ã“ã‚Œã‚’ãƒ•ã‚£ãƒƒã‚·ãƒ£ãƒ¼æ–¹ç¨‹å¼ (Fisher Equation) ã¨å‘¼ã³ã¾ã™.

### Monetary Neutrality in RBC Model

RBCãƒ¢ãƒ‡ãƒ«ã«ä¾¡æ ¼ãŒãªãœç™»å ´ã—ãªã‹ã£ãŸã‹ã¨ã„ã†ã¨, RBCãƒ¢ãƒ‡ãƒ«ã§ã¯ä¾¡æ ¼ãŒå®Œå…¨ã«æŸ”è»Ÿ (flexible) ã§ã‚ã‚‹ã¨ä»®å®šã—ã¦ãŠã‚Š, ä¾¡æ ¼ãŒçµŒæ¸ˆã«å½±éŸ¿ã‚’ä¸ãˆãªã„ **è²¨å¹£ä¸­ç«‹æ€§ (monetary neutrality)** ãŒæˆç«‹ã—ã¦ã„ã‚‹ã‹ã‚‰ã§ã™.

ã“ã“ã§, å¾“æ¥ã®RBCãƒ¢ãƒ‡ãƒ«ã«ä¾¡æ ¼ $P_t$ ã‚’å°å…¥ã—ã¦ã¿ã¾ã™. å˜ç´”åŒ–ã®ãŸã‚ã«, ç”Ÿç”£é–¢æ•°ã‚’ $y_t = w_t n_t$ ã¨ã—, åç›®è²¯è“„ã‚’ $A_t$ ã¨ã—ã¾ã™. ã™ã‚‹ã¨, å®¶è¨ˆã®äºˆç®—åˆ¶ç´„ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™.

$$
P_t c_t + A_{t} = P_t w_t n_t + (1 + i_t) A_{t-1}.
$$

ã“ã‚Œã‚’ $P_t$ ã§å‰²ã‚‹ã¨, $a_t = \frac{A_t}{P_t}$ ã¨ã™ã‚‹ã¨,

$$
c_t + a_{t} = w_t n_t + \underbrace{\frac{1 + i_t}{1 + \pi_t}}_{= 1 + r_t} a_{t-1}.
$$

ä¼æ¥­ã®åˆ©æ½¤ã¯ä»¥ä¸‹ã§ã‚ã‚Š, $P_t$ ã§å‰²ã£ã¦ã‚‚å®Ÿè³ªå€¤ $y_t, w_t, n_t$ ã«å½±éŸ¿ã—ã¾ã›ã‚“.
$$
\Pi_t = P_t y_t - P_t w_t n_t.
$$

æ¬¡ç¯€ä»¥é™ã§ã¯, ä¼æ¥­ã®ä¾¡æ ¼æ”¹è¨‚ã‚³ã‚¹ãƒˆã‚’å°å…¥ã™ã‚‹ã“ã¨ã§, ä¾¡æ ¼ãŒå®Ÿè³ªå€¤ã«å½±éŸ¿ã‚’ä¸ãˆã‚‹ã‚ˆã†ã«ã—ã¾ã™.

### Origin of Nominal Rigidity

ãƒ¢ãƒ‡ãƒ«ä¸Šã§ã¯æŠ½è±¡çš„ãªä¾¡æ ¼ã®ç¡¬ç›´æ€§ã‚’å°å…¥ã—ã¾ã™ãŒ, å…·ä½“çš„ã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ãªç†ç”±ã§ä¾¡æ ¼ã‚„è³ƒé‡‘ãŒç¡¬ç›´çš„ã«ãªã‚‹ã¨è€ƒãˆã‚‰ã‚Œã¦ã„ã¾ã™.

- **ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚³ã‚¹ãƒˆ** (menu cost): ä¾¡æ ¼ã‚’å¤‰æ›´ã™ã‚‹éš›ã«, å°åˆ·ã‚„åºƒå‘Šãªã©ã®ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ãŸã‚, ä¼æ¥­ã¯é »ç¹ã«ä¾¡æ ¼ã‚’å¤‰æ›´ã—ãªã„
- **åˆç†çš„ç„¡é–¢å¿ƒ** (rational inattention): æƒ…å ±ã‚’åé›†ã—å‡¦ç†ã™ã‚‹ã“ã¨ã«ã¯ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ãŸã‚, ä¼æ¥­ã¯åˆç†çš„ã«æƒ…å ±ã‚’ç„¡è¦–ã—, ä¾¡æ ¼ã‚’é »ç¹ã«å¤‰æ›´ã—ãªã„

![Chart 2 from @goldberg2007](/static/img/02-nk/goldberg2007_chart2.svg){#fig-goldberg2007 width=80%}

å®Ÿè¨¼çš„ã«ã‚‚ä¾¡æ ¼ã®ç¡¬ç›´æ€§ã¯è¦³æ¸¬ã•ã‚Œã¦ãŠã‚Š, @fig-goldberg2007 ã¯ãƒ“ãƒ¼ãƒ«ã®ä¾¡æ ¼ãŒã‚ã¾ã‚Šé »ç¹ã«å¤‰æ›´ã•ã‚Œãªã„ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™.

## Model

### IS-MP-PC ãƒ¢ãƒ‡ãƒ«

New Keynesian ãƒ¢ãƒ‡ãƒ«ã®åŸºæœ¬çš„ãªæ çµ„ã¿ã¯RBCãƒ¢ãƒ‡ãƒ«ã«ä¾¡æ ¼ç¡¬ç›´æ€§ã‚’åŠ ãˆãŸã‚‚ã®ã§ã™. ãƒ¢ãƒ‡ãƒ«ã®è¨­å®šã¯æ¬¡ç¯€ä»¥é™ã§è©³ã—ãèª¬æ˜ã—ã¾ã™ãŒ, æœ€çµ‚çš„ã«ã¯ä»¥ä¸‹ã®3ã¤ã®å¼ã«é›†ç´„ã•ã‚Œã¾ã™.

$$
\begin{aligned}
\widetilde{Y}_t &= \mathbb{E}_t\left[\widetilde{Y}_{t+1}\right] - \frac{1}{\sigma}\left(i_t -\mathbb{E}_t\left[\pi_{t+1}\right] - r_t^n\right) & \text{(NK IS Curve)} \\
\pi_{t} &= \beta \mathbb{E}_t\left[\pi_{t+1}\right] + \kappa \widetilde{Y}_t & \text{(NK Phillips Curve)} \\
i_t &= r_t + \phi_{\pi}\pi_t + \phi_y \widetilde{Y}_t & \text{(MP Rule)}\\
\end{aligned}
$$

- $\widetilde{Y}_t$: ç”£å‡ºã‚®ãƒ£ãƒƒãƒ— (output gap)
- $i_t$: åç›®é‡‘åˆ©
- $\pi_t$: ã‚¤ãƒ³ãƒ•ãƒ¬ç‡
- $r_t^n$: è‡ªç„¶åˆ©å­ç‡ (natural interest rate)

ãªãŠã“ã®æ–¹ç¨‹å¼ã¯ç·šå½¢ã§ã‚ã‚‹ãŸã‚, å…¨ã¦ã‚’100å€ã«ã—ãŸãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆè¡¨è¨˜ã«ã—ã¦ã‚‚åŒã˜ã§ã™. å°å‡ºã®éç¨‹ã§ã¯æ‰±ã„ã‚„ã™ã„å®Ÿéš›ã®å€¤ ($\pi_t$ = 0.01 ãªã‚‰ã°1%ã®ã‚¤ãƒ³ãƒ•ãƒ¬ç‡) ã§æ‰±ã„ã¾ã™ãŒ, IS-MP-PCã®å½¢ã«ãªã£ãŸå¾Œã¯, ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆã¨ã—ã¦æ‰±ã£ã¦ ($\pi_t = 1$ ãªã‚‰ã°1%ã®ã‚¤ãƒ³ãƒ•ãƒ¬ç‡) ã‚‚å•é¡Œã‚ã‚Šã¾ã›ã‚“. å®Ÿå‹™ä¸Šã¯ãƒ‘ãƒ¼ã‚»ãƒ³ãƒˆã¨ã—ã¦æ‰±ã£ã¦ã„ã‚‹ã‚‚ã®ãŒå¤šã„ã§ã™.

**Flexible Price Equilibrium**

é‡‘èæ”¿ç­–ã‚’è€ƒãˆã‚‹éš›ã«ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã¨ã—ã¦, ä¾¡æ ¼ãŒå®Œå…¨ã«æŸ”è»Ÿã§ã‚ã‚‹å ´åˆã®å‡è¡¡çŠ¶æ…‹ã‚’è€ƒãˆã¾ã™. ã“ã‚Œã‚’è‡ªç„¶ (natural) ãªçŠ¶æ…‹ã¨å‘¼ã³ã³, $x_t^n$ ã®ã‚ˆã†ã«è¡¨ã—ã¾ã™. ç”£å‡ºã‚®ãƒ£ãƒƒãƒ— $Y_t^n$ ã¯è‡ªç„¶æ°´æº–ã¨ã®å¯¾æ•°å·®ã§å®šç¾©ã•ã‚Œã¾ã™.

$$
\widetilde{Y}_t := \log Y_t - \log Y_t^n.
$$

### è¨­å®š

**å…¬å…±ã‚»ã‚¯ã‚¿ãƒ¼**

- ä¸­å¤®éŠ€è¡Œã¯åç›®åˆ©å­ç‡ã‚’åˆ¶å¾¡ã™ã‚‹é‡‘èãƒ«ãƒ¼ãƒ« (Monetary Policy Rule) ã‚’æŒã¤
- æ”¿åºœã¯ (ã“ã®æˆæ¥­ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯) è€ƒæ…®ã—ãªã„

**æ°‘é–“ã‚»ã‚¯ã‚¿ãƒ¼**

- æ°‘é–“ã‚»ã‚¯ã‚¿ãƒ¼ã¯, å®¶è¨ˆ, ä¸­é–“è²¡ä¼æ¥­, æœ€çµ‚è²¡ä¼æ¥­ã‹ã‚‰æ§‹æˆã•ã‚Œã‚‹
- å®¶è¨ˆã¯æœ€çµ‚è²¡ã‚’æ¶ˆè²»ã—, ä¸­é–“è²¡ä¼æ¥­ã«åŠ´åƒã‚’ä¾›çµ¦ã™ã‚‹
- æœ€çµ‚è²¡ä¼æ¥­ã¯ä¸­é–“è²¡ä¼æ¥­ã‹ã‚‰ä¸­é–“è²¡ã‚’èª¿é”ã—, æœ€çµ‚è²¡ã‚’ç”Ÿç”£ã™ã‚‹ (å®Œå…¨ç«¶äº‰)
- ä¸­é–“è²¡ä¼æ¥­ã¯å·®åˆ¥åŒ–ã•ã‚ŒãŸä¸­é–“è²¡ã‚’ç”Ÿç”£ã—, æœ€çµ‚è²¡ä¼æ¥­ã«è²©å£²ã™ã‚‹ (ç‹¬å çš„ç«¶äº‰)

**@rotemberg1982 vs. @calvo1983**

ä¾¡æ ¼ã®ç¡¬ç›´æ€§ã‚’è€ƒæ…®ã™ã‚‹éš›ã«, ä¾¡æ ¼ã®èª¿æ•´ãŒã©ã®ã‚ˆã†ã«è¡Œã‚ã‚Œã‚‹ã‹ã«ã¤ã„ã¦ã¯2ã¤ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒãŒã‚ã‚Šã¾ã™.

- **@rotemberg1982**: ä¾¡æ ¼ã®èª¿æ•´ã¯ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ã¨ã—, ä¾¡æ ¼ã‚’èª¿æ•´ã™ã‚‹ä¼æ¥­ã¯ãã®ã‚³ã‚¹ãƒˆã‚’è€ƒæ…®ã—ã¦ä¾¡æ ¼ã‚’è¨­å®šã™ã‚‹
- **@calvo1983**: ä¾¡æ ¼ã®èª¿æ•´ã¯ç¢ºç‡çš„ã«è¡Œã‚ã‚Œã‚‹ã¨ã—, å„ä¼æ¥­ãŒä¾¡æ ¼ã‚’èª¿æ•´ã™ã‚‹ç¢ºç‡ã‚’ä¸€å®šã¨ã™ã‚‹

IS-MP-PC ã®ã‚ˆã†ãªç·šå½¢åŒ–ã•ã‚ŒãŸãƒ¢ãƒ‡ãƒ«ã§ã¯, ã©ã¡ã‚‰ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’ç”¨ã„ã¦ã‚‚åŒã˜çµæœã«ãªã‚Šã¾ã™ãŒ, éç·šå½¢ã®ã¾ã¾æ•°å€¤è¨ˆç®—ã‚’è¡Œã†å ´åˆã¯çµæœãŒå°‘ã—ç•°ãªã‚Šã¾ã™. äºŒã¤ã®ãƒ¢ãƒ‡ãƒ«ã®é•ã„ã«ã¤ã„ã¦ã¯ @ascari2012 ãªã©ã‚’å‚ç…§ã—ã¦ãã ã•ã„. ã“ã®æˆæ¥­ã§ã¯, ç·šå½¢åŒ–ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’æ‰±ã†ã“ã¨ã¨, å°å‡ºãŒå¹³æ˜“ãªã“ã¨ã‹ã‚‰ @rotemberg1982 ã®ã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’æ¡ç”¨ã—ã¾ã™.


### å®¶è¨ˆ

ä»£è¡¨çš„ãªå®¶è¨ˆã¯ä»¥ä¸‹ã®æœŸå¾…å‰²å¼•ä¾¡å€¤ã‚’æœ€å¤§åŒ–ã™ã‚‹ã¨è€ƒãˆã¾ã™.

$$
U_0 = \mathbb{E}_0 \sum_{t=0}^{\infty} \beta^t \left(\frac{C_t^{1-\sigma}}{1-\sigma} - \frac{N_t^{1+\phi}}{1+\phi}\right)
$$

- $C_t$: (æœ€çµ‚è²¡) æ¶ˆè²»
- $N_t$: åŠ´åƒä¾›çµ¦

å®¶è¨ˆã®å„æœŸã®äºˆç®—åˆ¶ç´„ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™.

$$
P_t C_t + \frac{1}{1 + i_{t}} B_{t} = W_t N_t + \Pi_t + B_{t-1}.
$$

- $P_t$: æœ€çµ‚è²¡ä¾¡æ ¼
- $B_{t}$: åç›®å‚µåˆ¸ (nominal bond) ã®ä¸€æœŸä¿æœ‰é‡ (one-period bond holdings)
- $i_t$: åç›®é‡‘åˆ© (nominal interest rate)
- $W_t$: åç›®è³ƒé‡‘ (nominal wage)
- $\Pi_t$: ä¼æ¥­ã®åç›®åˆ©ç›Š (nominal profits)

**ãƒ™ãƒ«ãƒãƒ³æ–¹ç¨‹å¼**

$$
\begin{aligned}
V(B_{t-1}) &= \max_{C_t, N_t, B_t} \frac{C_t^{1-\sigma}}{1-\sigma} - \frac{N_t^{1+\phi}}{1+\phi} + \beta \mathbb{E}_t\left[V(B_{t})\right] \\
&=\max_{C_t, N_t} \frac{C_t^{1-\sigma}}{1-\sigma} - \frac{N_t^{1+\phi}}{1+\phi} + \beta \mathbb{E}_t\left[V\left((1+i_t)(W_t N_t + \Pi_t + B_{t-1} - P_t C_t)\right)\right]
\end{aligned}
$$

**æœ€é©æ¡ä»¶**

$$
\begin{aligned}
C_t^{-\sigma} &= \beta (1+i_t) P_t \mathbb{E}_t\left[V'(B_{t})\right] & \text{(FOC of $C_t$)} \\
N_t^{\phi} &= \beta (1+i_t) W_t \mathbb{E}_t\left[V'(B_{t})\right] & \text{(FOC of $N_t$)}\\
V'(B_{t-1}) &= \beta (1+i_t)\mathbb{E}_t\left[V'(B_{t})\right] & \text{(EC of $B_t$)}
\end{aligned}
$$

ã“ã“ã‹ã‚‰, $V'(B_{t-1}) = \frac{C_t^{-\sigma}}{P_t}$ ã‚ˆã‚Š, 

$$
\begin{aligned}
C_t^{-\sigma} &= \beta \mathbb{E}_t\left[\frac{P_t}{P_{t+1}} (1+i_t)C_{t+1}^{-\sigma}\right] & \text{(Euler equation)} \\
C_t^{-\sigma}\frac{W_t}{P_t} &= N_t^{\phi} & \text{(Intratemporal labor supply)}
\end{aligned}
$${#eq-opt-household}

ã“ã‚Œã¯å®Ÿè³ªå€¤ã‚’è€ƒãˆã‚‹ã¨, RBCãƒ¢ãƒ‡ãƒ«ã¨åŒã˜å«æ„ãŒå¾—ã‚‰ã‚Œã‚‹ã“ã¨ãŒåˆ†ã‹ã‚Šã¾ã™.

$$
\begin{aligned}
C_t^{-\sigma} &= \beta \mathbb{E}_t\left[(1 + r_t) C_{t+1}^{-\sigma}\right] \\
C_t^{-\sigma} w_t &= N_t^{\phi}
\end{aligned}
$$

### ä¼æ¥­

**ç”Ÿç”£**

æ¶ˆè²»è€…ã¯æœ€çµ‚è²¡ (final good) ã‚’æ¶ˆè²»ã—ã¾ã™. æœ€çµ‚è²¡ã¯ä»£è¡¨çš„ä¼æ¥­ãŒä¸­é–“è²¡ $j \in [0, 1]$ ã‚’ä»¥ä¸‹ã®CESç”Ÿç”£é–¢æ•°ã§ç”Ÿç”£ã—ã¾ã™.

$$
Y_t = \left(\int_{0}^{1} Y_{j, t}^{\frac{\varepsilon - 1}{\varepsilon}} \,dj\right)^{\frac{\varepsilon}{\varepsilon - 1}}.
$$

- $Y_{j, t}$: ä¸­é–“è²¡ $j$ ã®ç”Ÿç”£é‡
- $\varepsilon$: ä»£æ›¿å¼¾åŠ›æ€§ (elasticity of substitution)

ä¸­é–“è²¡ã¯ä»¥ä¸‹ã®ç·šå½¢ç”Ÿç”£é–¢æ•°ã§ç”Ÿç”£ã•ã‚Œã¾ã™.

$$
Y_{j, t} = A_t N_{j, t}
$$

**ä¾¡æ ¼**

æœ€çµ‚è²¡ã®ä¾¡æ ¼ $P_t$ ã¯ä¸­é–“è²¡ã®ä¾¡æ ¼ $P_{j, t}$ ã‚’ç”¨ã„ã¦ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™.

$$
P_t = \left(\int_{0}^{1} P_{j, t}^{1-\varepsilon} \, dj \right)^{\frac{1}{1-\varepsilon}}.
$$

è¨¼æ˜ã¯ @prp-price-index ã‚’å‚ç…§ã—ã¦ãã ã•ã„.

ä¸­é–“è²¡ã®ä¾¡æ ¼ $P_{j, t}$ ã¯, ä¼æ¥­ $j$ ãŒç‹¬å çš„ã«è¨­å®šã—ã¾ã™. ã“ã®ã‚³ã‚¹ãƒˆã¯, æœ€çµ‚è²¡ã§è¨ˆæ¸¬ã•ã‚Œ, ä»¥ä¸‹ã® @rotemberg1982 å‹ã®ä¾¡æ ¼æ”¹è¨‚ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚Šã¾ã™.

$$
\frac{\varphi}{2}\left(\frac{P_{j, t}}{P_{j, t-1}} - 1\right)^2 Y_t.
$$

ä¸­é–“è²¡ä¼æ¥­ã¯, è³ƒé‡‘ $W_t$ ã‚’ (ãƒ—ãƒ©ã‚¤ã‚¹ãƒ†ã‚¤ã‚«ãƒ¼ã¨ã—ã¦) æ”¯æ‰•ã„ã¾ã™. ãã®ãŸã‚, ä¸­é–“è²¡ä¼æ¥­ $j$ ã®é™ç•Œè²»ç”¨ (marginal cost) ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¡¨ã•ã‚Œã¾ã™.

$$
MC_{j, t} = \frac{W_t}{A_t}
$$

ã“ã‚Œã¯, ä¼æ¥­ã”ã¨ã«åŒä¸€ã®ãŸã‚ $MC_{t}$ ã¨è¡¨è¨˜ã—ã¾ã™.

**æœ€é©åŒ–å•é¡Œ**

ä¸­é–“è²¡ä¼æ¥­ $j$ ã¯ä»¥ä¸‹ã®ä¾¡å€¤é–¢æ•°ã‚’æœ€å¤§åŒ–ã—ã¾ã™.

$$
\max_{\{P_{j, t}\}_{t=0}^{\infty}} \mathbb{E}_{0} \sum_{t=0}^{\infty} D_{0, t} \left[
    \left(\frac{P_{j, t}}{P_t} - MC_{t}^{r}\right)Y_{j, t} -
    \frac{\varphi}{2}\left(\frac{P_{j, t}}{P_{j, t-1}} - 1\right)^2 Y_t
\right]
$$

ã“ã“ã§, $D_{0, t} := \beta^t \frac{U_{c}(t)}{U_{c}(0)}$ ã¯**ç¢ºç‡çš„å‰²å¼•å› å­**ï¼ˆstochastic discount factorï¼‰ã§ã™.

- ä¼æ¥­ã®æ‰€æœ‰è€…ã¯ä»£è¡¨çš„å®¶è¨ˆã§ã‚ã‚Šã€ä¼æ¥­ä¾¡å€¤ã¯å®¶è¨ˆã®åŠ¹ç”¨ã§æ¸¬å®šã•ã‚Œã‚‹
- $U_c(t) = C_t^{-\sigma}$ ã¯ $t$ æœŸã®æ¶ˆè²»ã®é™ç•ŒåŠ¹ç”¨
- $U_c(0)$ ã§å‰²ã‚‹ã“ã¨ã§, 0æœŸæ™‚ç‚¹ã®åŠ¹ç”¨ã‚’åŸºæº–ã«ç›¸å¯¾çš„ãªä¾¡å€¤ã‚’è¡¨ã™
- æœ€çµ‚è²¡ã®ä¾¡æ ¼ã‚’åŸºæº–ã«è€ƒãˆã‚‹ãŸã‚, å®Ÿè³ªé™ç•Œè²»ç”¨ $MC_{t}^{r} = \frac{W_t}{A_t P_t}$ ã‚’ç”¨ã„ã¾ã™.

ã“ã“ã‹ã‚‰ä»¥ä¸‹ã®ãƒ™ãƒ«ãƒãƒ³æ–¹ç¨‹å¼ã‚’å¾—ã¾ã™.

$$
V(P_{j, t-1}) = \max_{P_{j, t}} \left(\frac{P_{j, t}}{P_t} - MC_{t}^{r}\right)Y_{j, t} - \frac{\varphi}{2}\left(\frac{P_{j, t}}{P_{j, t-1}} - 1\right)^2 Y_{t} + \mathbb{E}_{t}[D_{t+1}V(P_{j, t})].
$$

ã“ã“ã§, $D_{t, t+1}$ ã‚’çœç•¥ã—ã¦, $D_{t+1} := \beta \frac{U_{c}(t+1)}{U_{c}(t)}$ ã¨ã—ã¾ã—ãŸ.

**æœ€é©ä¾¡æ ¼**

ä¸­é–“è²¡éœ€è¦ $Y_{j, t} = \left(\frac{P_{j, t}}{P_t}\right)^{-\varepsilon}Y_t$ ã‚’ä»£å…¥ã™ã‚‹ã¨, ãƒ™ãƒ«ãƒãƒ³æ–¹ç¨‹å¼ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™.

$$
V(P_{j, t-1}) = \max_{P_{j, t}} \left(\frac{P_{j, t}}{P_t} - MC_{t}^{r}\right)\left(\frac{P_{j, t}}{P_t}\right)^{-\varepsilon}Y_t - \frac{\varphi}{2}\left(\frac{P_{j, t}}{P_{j, t-1}} - 1\right)^2 Y_t + \mathbb{E}_{t}[D_{t+1}V(P_{j, t})].
$$

æœ€é©åŒ–æ¡ä»¶ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™.

$$
\left((1-\varepsilon)\left(\frac{P_{j, t}}{P_t}\right)^{-\varepsilon} + \varepsilon MC_{t}^{r} \left(\frac{P_{j, t}}{P_t}\right)^{-\varepsilon-1}\right)\frac{Y_t}{P_t} -
\varphi \left(\frac{P_{j, t}}{P_{j, t-1}} - 1\right)\frac{Y_t}{P_{j, t-1}} + \mathbb{E}_{t}[D_{t+1}V'(P_{j, t})] = 0
$$

$$
V'(P_{j, t-1}) = \varphi \left(\frac{P_{j,t}}{P_{j, t-1}} - 1\right)\frac{P_{j, t}}{P_{j, t-1}^2}Y_t
$$

å¯¾ç§°å‡è¡¡ã‚’ä»®å®šã™ã‚‹ã¨, å…¨ã¦ã®ä¼æ¥­ã¯åŒã˜ä¾¡æ ¼ã‚’è¨­å®šã™ã‚‹ãŸã‚, $P_{j, t} = P_t$ ã¨ãŠã‘ã¾ã™. ã“ã‚Œã«ã‚ˆã‚Š, æ¬¡ã®å¼ã‚’å¾—ã¾ã™.

$$
(1-MC_{t}^r)\varepsilon = 1 - \varphi\pi_{t}(1+\pi_{t}) + \varphi \beta\mathbb{E}_t\left[
  \left(\frac{C_{t+1}}{C_{t}}\right)^{-\sigma}\pi_{t+1}(1+\pi_{t+1})\frac{Y_{t+1}}{Y_t}
\right].
$${#eq-opt-price}

ã“ã“ã§ $1 + \pi_{t} := \frac{P_{t}}{P_{t-1}}$ ã¨ãŠãã¾ã—ãŸ.

### å‡è¡¡

**Market clearing**

$$
\begin{aligned}
N_t &= \int N_{j, t} \,dj & \text{Labor Market Clearing} \\
Y_t &= C_t & \text{Goods Market Clearing}
\end{aligned}
$$

@rotemberg1982 å‹ã®ãƒ¢ãƒ‡ãƒ«ã§ã¯, ä¾¡æ ¼æ”¹è¨‚ã®ã‚³ã‚¹ãƒˆã‚’

1. æ„æ€æ±ºå®šã«å½±éŸ¿ã‚’åŠã¼ã™ãŒ, å®Ÿä½“çµŒæ¸ˆã«ç›´æ¥çš„ãªå½±éŸ¿ã‚’ä¸ãˆãªã„
1. ä¾¡æ ¼æ”¹è¨‚ã«ã¯, æœ€çµ‚è²¡ã®ç”Ÿç”£é‡ã«ä¾å­˜ã™ã‚‹ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹

ã¨ã„ã†2ã¤ã®è€ƒãˆæ–¹ãŒã‚ã‚Šã¾ã™. $Y_t = C_t$ ã¨ã„ã†æ¡ä»¶ã¯ã“ã®1ã¤ç›®ã®è€ƒãˆæ–¹ã«åŸºã¥ã„ã¦ã„ã¾ã™. 2ã¤ç›®ã®è€ƒãˆæ–¹ã¯ Exercise ã§æ‰±ã„ã¾ã™.

### Flexible Price Equilibrium

ä¾¡æ ¼ãŒæŸ”è»Ÿã§ã‚ã‚‹å ´åˆ, ä¾¡æ ¼ã®æ”¹å®šã«ã¯ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚Šã¾ã›ã‚“. ã™ãªã‚ã¡, ãƒ™ãƒ«ãƒãƒ³æ–¹ç¨‹å¼ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«ãªã‚Šã¾ã™.

$$
V(P_{j, t-1}) = \max_{P_{j, t}} \left(\frac{P_{j, t}}{P_t} - MC_{t}^{r}\right)Y_{j, t} + \mathbb{E}_{t}[D_{t+1}V(P_{j, t})].
$$

ã“ã®æ™‚, $P_{j, t-1}$ ã«ä¾å­˜ã—ãªã„ãŸã‚, state variables ã«ã‚‚ãªã‚Šã¾ã›ã‚“. ã—ãŸãŒã£ã¦, ã•ã‚‰ã«æ›¸ãæ›ãˆã‚‹ã¨,

$$
V = \max_{P_{j, t}} \left(\frac{P_{j, t}}{P_t} - MC_{t}^{r}\right)Y_{j, t} + \mathbb{E}_{t}[D_{t+1}V].
$$

$Y_{j, t} = \left(\frac{P_{j, t}}{P_t}\right)^{-\varepsilon}Y_t$ ã‚’ä»£å…¥ã—, æœ€é©åŒ–æ¡ä»¶ã‚’æ±‚ã‚ã‚‹ã¨,

$$
(1-\varepsilon)\left(\frac{P_{j,t}}{P_t}\right)^{-\varepsilon} = MC_{t}^{r}(-\varepsilon)\left(\frac{P_{j,t}}{P_t}\right)^{-\varepsilon-1}.
$$

å¯¾ç§°å‡è¡¡ã‚’ä»®å®šã™ã‚‹ã¨, $P_{j, t} = P_t$ ã‚ˆã‚Š, ä»¥ä¸‹ã®å¼ã‚’å¾—ã¾ã™.

$$
MC_{t}^{r} = \frac{\varepsilon - 1}{\varepsilon} =: \frac{1}{\mu}.
$$

ã“ã“ã§, $\mu := \frac{\varepsilon}{\varepsilon - 1}$ ã¯ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ç‡ (markup rate) ã¨å‘¼ã°ã‚Œã¾ã™. ãƒãƒ¼ã‚¯ã‚¢ãƒƒãƒ—ç‡ã¯, ä¼æ¥­ãŒä¾¡æ ¼ã‚’è¨­å®šã™ã‚‹éš›ã«, é™ç•Œè²»ç”¨ã«å¯¾ã—ã¦ã©ã‚Œã ã‘ä¸Šä¹—ã›ã™ã‚‹ã‹ã‚’ç¤ºã™æŒ‡æ¨™ã§ã™. ã™ãªã‚ã¡,

$$
\frac{P_t}{MC_t} = \frac{1}{MC_t^r} =: \mu.
$$

Flexible price ã®å‡è¡¡ã«ãŠã‘ã‚‹å€¤ã‚’ $X^n$ ã§è¡¨ã™ã¨,

$$
\begin{aligned}
Y_t^n &= A_t N_t^n \\
MC_{t}^{r, n} &= \frac{W_t^n}{A_t P_t^n} = \frac{1}{\mu} \\
\frac{W_t^n}{P_t^n} &= {C_t^n}^{\sigma} {N_t^{n}}^{\phi} \\
Y_t^n &= C_t^n
\end{aligned}
$$

ã“ã‚Œã‚‰ã‚’æ•´ç†ã™ã‚‹ã¨, ä»¥ä¸‹ã®å¼ã‚’å¾—ã¾ã™.

$$
Y_t^n = \mu^{-\frac{1}{\sigma + \phi}} A_t^{\frac{1+\phi}{\sigma + \phi}}.
$${#eq-output-flexible}

ãªãŠ, å¯¾æ•°ç·šå½¢åŒ–ã™ã‚‹ã¨è‡ªæ˜ã«

$$
\hat{Y}_t^n = \frac{1+\phi}{\sigma + \phi} \hat{A}_t.
$${#eq-lin-output-flexible}

## IS-MP-PC ã®å°å‡º

ã“ã“ã§ã¯, å®šå¸¸çŠ¶æ…‹ã«ãŠã‘ã‚‹ã‚¼ãƒ­ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ $\pi = 0$ ã‚’ä»®å®šã—ã¾ã™. ã»ã¨ã‚“ã©ã®è«–æ–‡ã§ã¯ã“ã‚Œã‚’ä»®å®šã—ã¾ã™ãŒ, ä»®å®šã—ãªã„å ´åˆã¯ ISã¨PCã®å½¢ã¯è¤‡é›‘ã«ãªã‚Šã¾ã™. è©³ç´°ã¯ @ascari2012 ã‚’å‚ç…§ã—ã¦ãã ã•ã„.

ã¾ãŸ, ã‚¼ãƒ­ã‚¤ãƒ³ãƒ•ãƒ¬ã§ã¯ä¾¡æ ¼æ”¹è¨‚ãŒèµ·ã“ã‚‰ãªã„ã®ã§, å®šå¸¸çŠ¶æ…‹ã§ã¯ä¾¡æ ¼æ”¹è¨‚ã‚³ã‚¹ãƒˆã¯å­˜åœ¨ã—ã¾ã›ã‚“. ã—ãŸãŒã£ã¦, å®šå¸¸çŠ¶æ…‹ã§ã¯æŸ”è»Ÿä¾¡æ ¼å‡è¡¡ã¨åŒã˜å€¤ã‚’å–ã‚Šã¾ã™ $(Y = Y^n)$.

### New Keynesian IS Curve

@eq-opt-household ã®ã‚ªã‚¤ãƒ©ãƒ¼æ–¹ç¨‹å¼ã‹ã‚‰å°å‡ºã—ã¾ã™.

$$
C_t^{-\sigma} = \beta \mathbb{E}_t\left[\frac{1+i_t}{1+\pi_{t+1}}C_{t+1}^{-\sigma}\right]
$$

ã“ã‚Œã‚’å¯¾æ•°ç·šå½¢åŒ–ã™ã‚‹ã¨ (@prp-lin-nkis), ä»¥ä¸‹ã®å¼ã‚’å¾—ã¾ã™.

$$
\hat{C}_t = \mathbb{E}_t\left[\hat{C}_{t+1}\right] - \frac{1}{\sigma}\left(i_t + \log \beta - \mathbb{E}_t\left[\pi_{t+1}\right] \right)
$${#eq-lin-nkis}

@lem-output-gap ã‚ˆã‚Š, ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—ã¯ $\widetilde{Y}_t = \hat{Y}_t - \hat{Y}_t^n$ ã§ã‚ã‚Š, @eq-lin-output-flexible ã‚’ç”¨ã„ã‚‹ã¨,

$$
\hat{Y}_t = \widetilde{Y}_t + \frac{1+\phi}{\sigma + \phi} \hat{A}_t.
$$

Good Market Clearing ($C_t = Y_t$) ã‚ˆã‚Š, $\hat{C}_t = \hat{Y}_t$ ãªã®ã§,

$$
\widetilde{Y}_t = \mathbb{E}_t\left[\widetilde{Y}_{t+1}\right] - \frac{1}{\sigma}\left(i_t - \mathbb{E}_t\left[\pi_{t+1}\right] - r_t^n\right)
$${#eq-nk-is}

ãªãœãªã‚‰, è‡ªç„¶åˆ©å­ç‡ã¯ $r_t^n := i_t^n - \mathbb{E}_t\left[\pi_{t+1}^n\right]$ ã§å®šç¾©ã•ã‚Œ, @eq-lin-nkis ã¨ @eq-lin-output-flexible ã‚’ç”¨ã„ã‚‹ã¨,

$$
r_t^n = -\log \beta + \frac{\sigma(1+\phi)}{\sigma + \phi}\left(\mathbb{E}_t\left[\hat{A}_{t+1}\right] - \hat{A}_t\right).
$$

ã¨è¡¨ã•ã‚Œã‚‹ã‹ã‚‰ã§ã™. å®šå¸¸çŠ¶æ…‹ã§ã¯æ˜ã‚‰ã‹ã« $r^n = -\log \beta$ ã¨ãªã‚Šã¾ã™.

NKIS @eq-nk-is ã®è§£é‡ˆã¨ã—ã¦ã¯, ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—ãŒå°†æ¥ã®ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—äºˆæƒ³ $\mathbb{E}_t\left[\widetilde{Y}_{t+1}\right]$ ã¨, å®Ÿè³ªé‡‘åˆ©ã®ã‚®ãƒ£ãƒƒãƒ— $i_t - \mathbb{E}_t\left[\pi_{t+1}\right] - r_t^n$ ã«ã‚ˆã£ã¦æ±ºå®šã•ã‚Œã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™.

1. **å°†æ¥ã®ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—äºˆæƒ³**: å®¶è¨ˆã¯æ¶ˆè²»ã‚’å¹³æ»‘åŒ–ã—ã‚ˆã†ã¨ã™ã‚‹ãŸã‚, å°†æ¥ã®ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—ãŒé«˜ã„ã¨äºˆæƒ³ã•ã‚Œã‚‹å ´åˆ, ç¾åœ¨ã®ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—ã‚‚é«˜ããªã‚‹
1. **å®Ÿè³ªé‡‘åˆ©ã®ã‚®ãƒ£ãƒƒãƒ—**: å®Ÿè³ªé‡‘åˆ©ãŒé«˜ã„å ´åˆ, è²¯è“„ã‚’å¢—ã‚„ã—ç¾åœ¨ã®æ¶ˆè²»ã‚’æ¸›ã‚‰ã™. ãã®çµæœ, ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—ãŒæ¸›å°‘ã™ã‚‹

### New Keynesian Phillips Curve

@eq-opt-price ã®å¼ã‚’ç”¨ã„ã¦, ä¾¡æ ¼ã®ç¡¬ç›´æ€§ã‚’è€ƒæ…®ã—ãŸãƒ•ã‚£ãƒªãƒƒãƒ—ã‚¹æ›²ç·šã‚’å°å‡ºã—ã¾ã™.

$$
(1-MC_{t}^r)\varepsilon = 1 - \varphi\pi_{t}(1+\pi_{t}) + \varphi \beta\mathbb{E}_t\left[
  \left(\frac{C_{t+1}}{C_{t}}\right)^{-\sigma}\pi_{t+1}(1+\pi_{t+1})\frac{Y_{t+1}}{Y_t}
\right].
$$

ã“ã‚Œã‚’å¯¾æ•°ç·šå½¢åŒ–ã™ã‚‹ã¨ (@prp-lin-nkpc), ä»¥ä¸‹ã®å¼ã‚’å¾—ã¾ã™.

$$
\begin{aligned}
\pi_t&= \beta \mathbb{E}_t\left[\pi_{t+1}\right] + (1-\beta)\pi +
\frac{\varepsilon-1 + (1-\beta)\varphi\pi(1+\pi)}{\varphi(1+\pi)(1+2\pi)}\widehat{MC^r}_{t} \\
&+\frac{\beta\pi}{\varphi(1+2\pi)}\mathbb{E}_t\left[\Delta \hat{Y}_{t+1} - \sigma \Delta\hat{C}_{t+1}\right]
\end{aligned}
$$

$\pi = 0$ ã‚ˆã‚Š,

$$
\pi_{t} = \beta \mathbb{E}_t\left[\pi_{t+1}\right] + \frac{\varepsilon-1}{\varphi} \widehat{MC^r}_{t}.
$$

@lem-lin-mc ã‚’ç”¨ã„ã¦,

$$
\pi_{t} = \beta \mathbb{E}_t\left[\pi_{t+1}\right] + \frac{\varepsilon-1}{\varphi} (\sigma+\phi)\widetilde{Y}_t.
$$

$\kappa = \frac{(\varepsilon-1)(\sigma+\phi)}{\varphi}$ ã¨ã™ã‚‹ã¨,

$$
\pi_t = \beta \mathbb{E}_t\left[\pi_{t+1}\right] + \kappa \widetilde{Y}_t.
$${#eq-nk-pc}

è§£é‡ˆã¨ã—ã¦ã¯, ç¾åœ¨ã®ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ãŒå°†æ¥ã®ã‚¤ãƒ³ãƒ•ãƒ¬äºˆæƒ³ $\mathbb{E}_t\left[\pi_{t+1}\right]$ ã¨, ç¾åœ¨ã®æ™¯æ°—çŠ¶æ³ $\widetilde{Y}_t$ ã«ã‚ˆã£ã¦æ±ºå®šã•ã‚Œã‚‹ã“ã¨ã‚’ç¤ºã—ã¦ã„ã¾ã™.

1. **ã‚¤ãƒ³ãƒ•ãƒ¬äºˆæƒ³**: æ€¥æ¿€ãªä¾¡æ ¼æ”¹è¨‚ã¯ã‚³ã‚¹ãƒˆãŒã‹ã‹ã‚‹ãŸã‚, ã‚¤ãƒ³ãƒ•ãƒ¬ãŒäºˆæƒ³ã•ã‚Œã‚‹å ´åˆã¯, ä¼æ¥­ã¯äº‹å‰ã«ä¾¡æ ¼ã‚’å¼•ãä¸Šã’ã‚‹
1. **ç”£å‡ºã‚®ãƒ£ãƒƒãƒ—**: éœ€è¦ãŒé«˜ã¾ã‚‹ã¨, åŠ´åƒéœ€è¦ãŒé«˜ã¾ã‚Š, è³ƒé‡‘ãŒä¸Šæ˜‡ã™ã‚‹. ä¼æ¥­ã¯ã‚³ã‚¹ãƒˆä¸Šæ˜‡ã‚’ä¾¡æ ¼ã«è»¢å«ã—, ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ãŒä¸Šæ˜‡ã™ã‚‹

### Monetary Policy Rule (Taylor Rule)

@taylor1993 ã¯1987-1992å¹´ã® Federal Reserve ã®æ”¿ç­–ã‚’åˆ†æã—, ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ«ãƒ¼ãƒ«ã‚’ææ¡ˆã—ã¾ã—ãŸ.

$$
i_t = r^n + \phi_{\pi}(\pi_t - \pi^*) + \phi_y \widetilde{Y}_t
$${#eq-taylor-rule}

@taylor1993 ã§ã¯ $\phi_{\pi} = 1.5$, $\phi_{y} = 0.5$ ã¨ã—ã¦ã„ã¾ã™. è§£é‡ˆã¨ã—ã¦ã¯,

- $\phi_{\pi} > 1$ ã®å ´åˆ, ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ãŒç›®æ¨™ã‚’ä¸Šå›ã‚‹ã¨ã, é‡‘åˆ©ã‚’ä¸Šã’ã‚‹ã“ã¨ã§ã‚¤ãƒ³ãƒ•ãƒ¬ã‚’æŠ‘åˆ¶ã—ã‚ˆã†ã¨ã™ã‚‹
- $\phi_y > 0$ ã®å ´åˆ, GDPã‚®ãƒ£ãƒƒãƒ—ãŒæ­£ã®ã¨ã, é‡‘åˆ©ã‚’ä¸Šã’ã‚‹ã“ã¨ã§æ™¯æ°—ã‚’æŠ‘åˆ¶ã—ã‚ˆã†ã¨ã™ã‚‹

FRB of Atlanta ã® [Taylor Rule Utility](https://www.atlantafed.org/cqer/research/taylor-rule) ã§ã¯, ã„ãã¤ã‹ã®ãƒ¢ãƒ‡ãƒ«ã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’æŒ‡å®šã—ã¦, Taylor Rule ã¨å®Ÿéš›ã®é‡‘åˆ© (Fed Funds Rate) ã®æ¯”è¼ƒã‚’è¡Œã†ã“ã¨ãŒã§ãã¾ã™ [@fig-taylor-rule]. "Alternative 3" ã¨ã—ã¦è¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ãƒ«ãƒ¼ãƒ«ãŒ @taylor1993 ã®ãƒ«ãƒ¼ãƒ«ã«è¿‘ã„ã‚‚ã®ã§ã™. @taylor1993 ã®è¦³æ¸¬ã—ãŸ1987-1992å¹´ã®æœŸé–“ã‚’ã‚ˆãèª¬æ˜ã—ã¦ã„ã‚‹ã ã‘ã§ãªã, ãã®å¾Œã®æœŸé–“ã‚‚ã‚ã‚‹ç¨‹åº¦èª¬æ˜ã§ãã¦ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™. 

![Taylor Rules from Fedral Reserve Bank of Atlanta.](/static/img/02-nk/atlanta-fed_taylor-rule.svg){#fig-taylor-rule width=90%}

ãªãŠ, å®Ÿéš›ã®é‡‘åˆ©ã¯é‡‘åˆ©ã‚¼ãƒ­åˆ¶ç´„ (Zero Lower Bound, ZLB) ã«ã‚ˆã£ã¦åˆ¶ç´„ã•ã‚Œã‚‹ãŸã‚, è¶…ä½é‡‘åˆ©ã®å ´åˆã§ã¯ Taylor Rule ãŒé©ç”¨ã§ããªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„. ZLBã‚’è€ƒæ…®ã—ãŸæ•°å€¤è¨ˆç®—ãƒ¢ãƒ‡ãƒ«ã¨ã—ã¦ã¯, @adam2007 ãªã©ãŒã‚ã‚Š, @kitao2024 ã®7ç« ã§è©³ã—ãèª¬æ˜ã•ã‚Œã¦ã„ã¾ã™.

## Simulation

ã“ã“ã‹ã‚‰ã¯, Impulse Response Function (IRF) ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¦ã„ãã¾ã™. ã¾ãŸ, å˜ç´”åŒ–ã®ãŸã‚, ä¸­å¤®éŠ€è¡Œã®ç›®æ¨™ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã¯ $\pi^* = 0$ ã¨ã—ã¾ã™. ã“ã‚Œã¯, å®šå¸¸çŠ¶æ…‹ã®ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ã‚’0ã¨ä»®å®šã—ã¦ã„ã‚‹ã“ã¨ã¨æ•´åˆçš„ã«ãªã‚‹ã‹ã‚‰ã§ã™.^[
  Taylor Rule ãŒå®Ÿè¨¼çš„ã«ã¯2%ã‚’ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ã—ã¦ã„ã‚‹ã“ã¨ã¨æ•´åˆçš„ã§ãªã„ã“ã¨ã«æ³¨æ„ã—ã¦ãã ã•ã„. å®šå¸¸çŠ¶æ…‹ã®ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ãŒ0ã§ãªã„ã¨ä»®å®šã™ã‚‹å ´åˆã¯, NKIS, NKPCã®å½¢ã¯å°‘ã—è¤‡é›‘ã«ãªã‚Šã¾ã™. è©³ã—ãã¯ @ascari2012 ã‚’å‚ç…§ã—ã¦ãã ã•ã„.
]

### Calibration

**Parameters**

ãƒ¢ãƒ‡ãƒ«ã®ä¸€æœŸé–“ã¯å››åŠæœŸã¨ã—, ä»¥ä¸‹ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’è¨­å®šã—ã¾ã™. @ascari2012 ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ç”¨ã„ã¾ã™.

::: {#tbl-nk-parameters tbl-colwidths="[30, 30]"}

|   **Parameter**    | **Description**             |
|:------------------:|:----------------------------|
|    $\beta=0.99$    | $\beta = 0.96$ ã®å››åŠæœŸæ›ç®— |
|     $\sigma=1$     | Log Utility                 |
|      $\phi=1$      | Unitary Frisch elasticity   |
| $\varepsilon=10.0$ | Literature                  |
|  $\varphi=104.9$   | è„šæ³¨å‚ç…§[^1]                |
|  $\phi_{\pi}=1.5$  | @taylor1993                 |
|  $\phi_{y}=0.125$  | @taylor1993 ã®å››åŠæœŸæ›ç®—    |

New Keynesian Model Parameters
:::

[^1]: @ascari2012 ã®ä¸­ã§, Calvoå‹ã®ä¾¡æ ¼æ”¹è¨‚ç¢ºç‡ã‚’ $1-\theta=0.25$ ã¨ã—ãŸå ´åˆ, å¯¾å¿œã™ã‚‹Rotembergaå‹ã®ä¾¡æ ¼æ”¹è¨‚ã‚³ã‚¹ãƒˆã¯ $\varphi=\frac{(\varepsilon-1)\theta}{(1-\theta)(1-\beta\theta)}$.


**Monetary Policy Shocks**

IRFã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã«, @eq-taylor-rule ã«ä»¥ä¸‹ã®ã‚·ãƒ§ãƒƒã‚¯ã‚’ä¸ãˆã¾ã™.

$$
\begin{aligned}
i_t &= r^n + \phi_{\pi}\pi_t + \phi_y \widetilde{Y}_t + \eta_t \\
\eta_t &= \rho_{\eta} \eta_{t-1} + \sigma_{\eta} \epsilon_t.
\end{aligned}
$$

IRFã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã§ã¯, $t=0$ æ™‚ç‚¹ã§ $\epsilon_t = 1$ã€€ã¨ã—, ãã®ã‚ã¨ã¯ $\epsilon_t = 0$ ã¨ã—ã¾ã™. @gali2015 ã®Chapter 3ã«å¾“ã„, $\rho_{\eta} = 0.5$, $\sigma_{\eta} = 0.25$ ã¨ã—ã¾ã™.

### IRF from Scratch

@eq-nk-is, @eq-nk-pc, @eq-taylor-rule ã‚’æ•´ç†ã™ã‚‹ã¨ä»¥ä¸‹ã‚’å¾—ã¾ã™.

$$
\begin{pmatrix}
\widetilde{Y}_t \\
\pi_t
\end{pmatrix}
=\omega\underbrace{\begin{pmatrix}
\sigma & 1-\beta\phi_{\pi} \\
\sigma\kappa & \kappa+\beta(\sigma+\phi_y)
\end{pmatrix}}_{\Lambda}
\begin{pmatrix}
\mathbb{E}_t\left[\widetilde{Y}_{t+1}\right] \\
\mathbb{E}_t\left[\pi_{t+1}\right]
\end{pmatrix}
+\omega\underbrace{\begin{pmatrix}
1\\
\kappa
\end{pmatrix}}_{\mathbf{b}}
\left(\hat{r}_t^n - \eta_t\right).
$$

ã“ã“ã§, $\omega = (\sigma+\phi_y+\phi_{\pi}\kappa)^{-1}$, $\hat{r}_t^n = r_t^n - r^n$ ã§ã™. Monetary policy shocks ã¯è‡ªç„¶åˆ©å­ç‡ã«å½±éŸ¿ã‚’ä¸ãˆãªã„ãŸã‚, $\hat{r}_t^n = 0$ ã¨ã—ã¾ã™.

ã“ã®ã‚ˆã†ã«, æœŸå¾…æ¼”ç®—å­ã‚’å«ã‚€ç·šå½¢ã‚·ã‚¹ãƒ†ãƒ ãŒå¾—ã‚‰ã‚Œã¾ã—ãŸ. ã“ã‚Œã‚’å‰æ–¹æœŸå¾… (foward-looking) ã‚’å«ã‚€ç·šå½¢ãƒ¢ãƒ‡ãƒ«ã¨å‘¼ã³, ã“ã®ã‚ˆã†ãªãƒ¢ãƒ‡ãƒ«ã‚’è§£ãã«ã¯ guess-and-verify ãŒæœ‰åŠ¹ã§ã™.

ã“ã®ã‚·ã‚¹ãƒ†ãƒ ã®è§£ãŒä»¥ä¸‹ã®å½¢ã‚’æº€ãŸã™ã¨ã—ã¾ã™.

$$
\widetilde{Y}_t = \psi_y \eta_t, \quad \pi_t = \psi_{\pi} \eta_t.
$$

ã“ã‚Œã‚’ä»£å…¥ã—ã¦, $(\psi_y, \psi_{\pi})$ ã«å¯¾ã—ã¦è§£ãã¨,

$$
\begin{aligned}
\begin{pmatrix}
\psi_y\\\psi_{\pi}
\end{pmatrix}\eta_t&=\omega \Lambda\begin{pmatrix}
\psi_y\\\psi_{\pi}
\end{pmatrix}\mathbb{E}_t\left[\eta_{t+1}\right] + \omega \mathbf{b} \eta_t\\
&=\omega \Lambda\begin{pmatrix}
\psi_y\\\psi_{\pi}
\end{pmatrix}
\rho_{\eta}\eta_t + \omega \mathbf{b} \eta_t\\
\begin{pmatrix}
\psi_y\\\psi_{\pi}
\end{pmatrix}&=(I - \omega\rho_{\eta}\Lambda)^{-1} \omega \mathbf{b}.
\end{aligned}
$$

ã“ã®ã‚ˆã†ã«ã—ã¦, $\psi_y, \psi_{\pi}$ ã‚’æ±‚ã‚ã‚‹ã“ã¨ãŒã§ãã‚Œã°^[
  è§£ã®å”¯ä¸€æ€§ã¨å¿…è¦ååˆ†æ¡ä»¶ã¯, $\phi_y, \phi_{\pi} > 0$ ã«å¯¾ã—ã¦,
  $$
  \kappa(\phi_{\pi}-1) + (1-\beta)\phi_y > 0.
  $$
  å°å‡ºã¯, @bullard2002 ã‚’å‚ç…§ã—ã¦ãã ã•ã„.
], IRFã‚’è¨ˆç®—ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™.

```{julia}
#| label: model-nk-scratch
#| output: false
#| code-fold: show
module My

@kwdef struct NK{TF<:AbstractFloat}
    Î²::TF = 0.99
    Ïƒ::TF = 1.0
    Ï•::TF = 1.0
    Îµ::TF = 10.0
    Î¸::TF = 0.75
    Ï†::TF = (Îµ - 1) * Î¸ / ((1 - Î¸) * (1 - Î² * Î¸))
    Îº::TF = (Îµ - 1) * (Ïƒ + Ï•) / Ï†
    Ï•_Ï€::TF = 1.5
    Ï•_y::TF = 0.125
    râ¿::TF = -log(Î²)
    Ï_Î·::TF = 0.5
    Ïƒ_Î·::TF = 0.25
end

function get_irf(m::NK; T=12, Ïƒ_Îµ=0.25)
    (; Î², Ïƒ, Îº, râ¿, Ï•_Ï€, Ï•_y, Ï_Î·) = m

    # Sequence of Shocks
    Î·s = zeros(T + 1)
    Î·s[1] = Ïƒ_Îµ
    for t in 1:T
        Î·s[t+1] = Ï_Î· * Î·s[t]
    end

    # IRF
    Ï‰ = 1 / (Ïƒ + Ï•_y + Ï•_Ï€ * Îº)
    Î› = [Ïƒ (1-Î²*Ï•_Ï€)
        Ïƒ*Îº Îº+Î²*(Ïƒ+Ï•_y)]
    ğ› = [1, Îº]

    Ïˆ_y, Ïˆ_Ï€ = ([1 0; 0 1] - Ï‰ * Ï_Î· * Î›) \ (-Ï‰ * ğ›)
    yÌƒs = Ïˆ_y * Î·s
    Ï€s = Ïˆ_Ï€ * Î·s
    is = râ¿ .+ Ï•_Ï€ * Ï€s .+ Ï•_y * yÌƒs .+ Î·s

    return yÌƒs, Ï€s, is, Î·s
end

end # module
```

```{julia}
#| label: fig-nk-scratch
#| fig-cap: "IRF of New Keynesian Model from Scratch"
#| code-fold: true
m = My.NK()
T = 12
yÌƒs, Ï€s, is, Î·s = My.get_irf(m, T=T)

p1 = plot(0:T, yÌƒs, title=L"Output Gap $\widetilde{Y}_t$", label=false)
p2 = plot(0:T, Ï€s, title=L"Inflation $\pi_t$", label=false)
p3 = plot(0:T, is, title=L"Nominal Interest Rate $i_t$", label=false)
p4 = plot(0:T, Î·s, title=L"Shock $\eta_t$", label=false)

p = plot(p1, p2, p3, p4, layout=(2, 2), xticks=0:2:T)
```

è§£é‡ˆã¨ã—ã¦ã¯, æ­£ã®é‡‘åˆ©ã‚·ãƒ§ãƒƒã‚¯ãŒèµ·ããŸæ™‚

- å®Ÿè³ªé‡‘åˆ©ã®å¢—åŠ ã«ã‚ˆã‚Š, ç¾åœ¨ã®æ¶ˆè²»ãŒæ¸›å°‘ (NKIS)
- $Y_t = C_t$ ã‹ã¤, $Y_t^n$ ã¯å½±éŸ¿ã‚’å—ã‘ãªã„ãŸã‚, Output Gap $\widetilde{Y}_t$ ãŒæ¸›å°‘
- Output Gapã®æ¸›å°‘ã«ã‚ˆã‚Š, ã‚¤ãƒ³ãƒ•ãƒ¬ç‡ $\pi_t$ ãŒæ¸›å°‘ (NKPC)

### IRF by MacroModelling.jl

åŒã˜ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’, `MacroModelling.jl` ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ç”¨ã„ã¦è¡Œã†ã“ã¨ã‚‚ã§ãã¾ã™. ç·šå½¢åŒ–ã—ãŸãƒ¢ãƒ‡ãƒ«ã‚’ç”¨ã„ã¦ã‚‚ã„ã„ã§ã™ãŒ, éç·šå½¢ãªãƒ¢ãƒ‡ãƒ«ã‚’ç›´æ¥å®šç¾©ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™.

```{julia}
#| label: model-nk-macromodelling
#| code-fold: show
#| output: false
@model NK begin
    C[0]^(-Ïƒ) = Î² * (1 + i[0]) / (1 + Ï€[1]) * C[1]^(-Ïƒ)
    N[0]^Ï• = C[0]^(-Ïƒ) * Wr[0]
    (1 - MCr[0]) * Îµ = 1 - Ï† * Ï€[0] * (1 + Ï€[0]) +
                       Ï† * Î² * (C[1] / C[0])^(-Ïƒ) * Ï€[1] * (1 + Ï€[1]) * Y[1] / Y[0]
    i[0] = râ¿ + Ï•_Ï€ * Ï€[0] + Ï•_y * yÌƒ[0] + Î·[0]
    Y[0] = A * N[0]
    Y[0] = C[0]
    yÌƒ[0] = log(Y[0]) - log(Yâ¿)
    MCr[0] = Wr[0] / A
    Î·[0] = Ï_Î· * Î·[-1] + Ïƒ_Ïµ * Ïµ[x]
end

@parameters NK begin
    Ïƒ = 1.0
    Ï• = 1.0
    Îµ = 10.0
    Î¸ = 0.75
    Ï† = (Îµ - 1) * Î¸ / ((1 - Î¸) * (1 - Î² * Î¸))
    A = 1.0
    Î² = 0.99
    râ¿ = -log(Î²)
    Yâ¿ = Î¼^(-1 / (Ïƒ + Ï•)) * A^((1 + Ï•) / (Ïƒ + Ï•))
    Î¼ = Îµ / (Îµ - 1)
    Ï•_Ï€ = 1.5
    Ï•_y = 0.125
    Ï_Î· = 0.5
    Ïƒ_Ïµ = 0.25
end
```

```{julia}
#| label: fig-nk-macromodelling
#| fig-cap: "IRF of New Keynesian Model by MacroModelling.jl"
#| code-fold: true
T = 12
irf = get_irf(NK, periods=T + 1, variables=[:i, :Î·, :Ï€])
yÌƒs = collect(get_irf(NK, periods=T + 1, variables=[:yÌƒ], levels=true)[1, :])

p1 = plot(0:T, yÌƒs, title=L"Output Gap $\widetilde{Y}_t$", label=false)
p2 = plot(0:T, irf[3, :], title=L"Inflation $\pi_t$", label=false)
p3 = plot(0:T, irf[1, :], title=L"Nominal Interest Rate $i_t$", label=false)
p4 = plot(0:T, irf[2, :], title=L"Shock $\eta_t$", label=false)

plot(p1, p2, p3, p4, layout=(2, 2), xticks=0:2:T)
```

@fig-nk-scratch ã¨å…¨ãåŒã˜çµæœãŒå¾—ã‚‰ã‚Œã¾ã™. å®Ÿã¯, `MacroModelling.jl` ã‚„ `Dynare` ã¨ã„ã£ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯, å¯¾æ•°ç·šå½¢åŒ–ã¨ãã®ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’è‡ªå‹•ã§è¡Œã†ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ã ã£ãŸã§ã™.^[
  å¯¾æ•°ç·šå½¢åŒ–ã¯ä¸€æ¬¡è¿‘ä¼¼ã«éãã¾ã›ã‚“ãŒ, ã“ã‚Œã‚‰ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã§ã¯ã‚ˆã‚Šé«˜æ¬¡ã®è¿‘ä¼¼ã‚‚å¯èƒ½ã§ã™.
]

